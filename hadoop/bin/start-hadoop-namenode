#!/usr/bin/env bash

# Starts the Hadoop name node. Expects the daemon flag as a parameter

source /etc/bash.bashrc

# Format namenode
if [ ! -f /opt/hdfs/name/current/VERSION ]; then
  hdfs namenode -format -force
fi
# Start HDFS service
start-dfs.sh
# Fix permissions for root directory
hdfs dfs -chown $HDFS_USER:$HDFS_GROUP /
# Start daemon if specified
if [[ "${1}" != 'daemon' ]]; then
  sleep infinity
fi
