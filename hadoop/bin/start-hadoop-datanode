#!/usr/bin/env bash

# Starts the Hadoop data node. Expects the name node host and the daemon flag
# as parameters
echo "run start-hadoop-datanode"
source /etc/bashrc

# Wait for the name node to be online
while ! nc -w 2 namenode 50070 </dev/null; do
  sleep 3;
done;

# Start HDFS data node
hadoop-daemon.sh start datanode

# Start YARN node manager
yarn-daemons.sh start nodemanager

# Start daemon if specified
if [[ "${1}" != 'daemon' ]]; then
  sleep infinity
fi

echo "run start-hadoop-datanode done"